{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 23,
  "summary": "Build a mobile app called \"Helthcare Reception\" with welcome screen, authentication (login + create account), first-time role selection (job seeker vs recruiter) with area details, job seeker application upload, and recruiter browsing of local applicants.",
  "architectural_notes": [
    "Persist user account and login session data.",
    "Store applicant profiles (name, email, phone, gender, photo, area) and support querying applicants by area for recruiter flow.",
    "Role selection should be asked only on first login; allow returning users to go directly to their role home flow.",
    "Treat backend actor initialization as a first-class readiness state; avoid firing authenticated/profile queries until backend connectivity is confirmed, and use retry/backoff rather than showing a refresh-required error."
  ],
  "known_issues": [
    "Performance issue: After logging in, the next page/screen takes a long time to open (slow post-login navigation/loading).",
    "After login, an error message appears: \"Unable to load your account\" (post-login profile/account load failing).",
    "Login page: input boxes/fields are not working (cannot interact/type/tap).",
    "Login flow shows error: \"Failed to connect to the backend system. Please refresh the page to try again.\" (backend actor not ready / transient connection failure during initialization).",
    "Some options/screens are still not loading for the user (user reports: \"Come option we are don't enable to load\").",
    "After login, the app shows a \"can't load\" state and the role selection screen (red/blue boxes) does not appear.",
    "Login is failing (user reports they cannot successfully log in).",
    "Role selection screen shows incorrect message implying only admins can choose a role (should allow all users to choose role on first login)."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-set-the-application-name-branding-to-helthcare-reception-and-implement-a-launch-welcome-screen-that-displays-the-text-welcome-to-helthcare-reception-before-navigating-into-authentication",
      "title": "Set the application name/branding to \"Helthcare Reception\" and implement a launch/welcome screen that displays the text \"Welcome to helthcare reception.\" before navigating into authentication.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-email-password-login-ui-and-backend-api-users-can-log-in-using-email-id-and-password-successful-login-establishes-an-authenticated-session-state-in-the-frontend",
      "title": "Implement email/password login UI and backend API: users can log in using Email ID and Password; successful login establishes an authenticated session state in the frontend.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-account-creation-sign-up-ui-and-backend-api-that-collects-name-email-phone-number-gender-and-password-after-successful-sign-up-redirect-the-user-to-the-login-screen",
      "title": "Implement account creation (sign up) UI and backend API that collects Name, Email, Phone Number, Gender, and Password; after successful sign up, redirect the user to the login screen.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-after-login-show-a-role-selection-screen-with-exactly-two-large-selectable-boxes-1-red-box-labeled-search-for-reception-job-and-2-blue-box-labeled-search-for-receptionist-this-role-selection-should-only-be-asked-once-first-time-after-the-user-s-first-successful-login-and-not-shown-again-on-subsequent-logins-unless-the-user-has-not-completed-onboarding",
      "title": "After login, show a role selection screen with exactly two large selectable boxes: (1) red box labeled \"Search for reception job\" and (2) blue box labeled \"Search for receptionist\". This role selection should only be asked once (first time after the user's first successful login) and not shown again on subsequent logins unless the user has not completed onboarding.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-the-one-time-area-location-details-form-city-district-state-country-that-is-presented-after-role-selection-for-both-roles-and-persist-these-fields-to-the-backend-associated-with-the-logged-in-user",
      "title": "Implement the one-time area/location details form (City, District, State, Country) that is presented after role selection for both roles, and persist these fields to the backend associated with the logged-in user.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-job-seeker-flow-red-role-search-for-reception-job-after-area-submission-allow-the-user-to-upload-a-photo-from-their-device-and-submit-an-application-persist-an-application-record-containing-the-user-s-name-email-phone-number-gender-area-city-district-state-country-and-uploaded-photo-after-submission-show-a-confirmation-message-your-application-applied",
      "title": "Job seeker flow (red role: \"Search for reception job\"): after area submission, allow the user to upload a photo from their device and submit an application; persist an application record containing the user's Name, Email, Phone Number, Gender, Area (City/District/State/Country), and uploaded Photo; after submission show a confirmation message \"Your application applied.\"",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-job-seeker-home-page-red-role-provide-a-screen-where-the-job-seeker-can-view-their-submitted-application-data-and-update-change-their-information-including-area-fields-and-photo-and-re-submit-to-save-changes",
      "title": "Job seeker home page (red role): provide a screen where the job seeker can view their submitted application data and update/change their information (including area fields and photo) and re-submit to save changes.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-recruiter-flow-blue-role-search-for-receptionist-after-area-submission-show-a-list-of-job-seeker-applications-red-role-users-whose-area-matches-the-recruiter-s-area-display-at-minimum-name-email-phone-number-gender-and-the-submitted-photo-for-each-matching-applicant",
      "title": "Recruiter flow (blue role: \"Search for receptionist\"): after area submission, show a list of job seeker applications (red-role users) whose area matches the recruiter's area; display at minimum Name, Email, Phone Number, Gender, and the submitted Photo for each matching applicant.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-consistent-creative-visual-theme-across-the-frontend-colors-typography-layout-appropriate-for-a-healthcare-reception-marketplace-avoid-using-a-blue-purple-primary-combo",
      "title": "Apply a consistent, creative visual theme across the frontend (colors, typography, layout) appropriate for a healthcare reception marketplace; avoid using a blue+purple primary combo.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-onboarding-profile-loading-ux-so-the-user-always-sees-a-responsive-transition-after-login-while-the-app-fetches-the-user-profile-used-for-onboarding-routing-role-location-completion-add-clear-loading-messaging-english-and-avoid-blank-unclear-intermediate-states-during-the-first-post-login-profile-fetch",
      "title": "Improve onboarding/profile-loading UX so the user always sees a responsive transition after login while the app fetches the user profile used for onboarding routing (role/location completion). Add clear loading messaging (English) and avoid blank/unclear intermediate states during the first post-login profile fetch.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-scope-onboarding-status-caching-correctly-to-the-authenticated-user-to-avoid-slow-or-incorrect-transitions-across-sessions-ensure-the-current-user-profile-query-is-keyed-by-the-authenticated-identity-principal-so-cached-data-does-not-cause-extra-refetch-loops-or-incorrect-routing-when-users-change",
      "title": "Scope onboarding status caching correctly to the authenticated user to avoid slow or incorrect transitions across sessions. Ensure the \"current user profile\" query is keyed by the authenticated identity (principal) so cached data does not cause extra refetch loops or incorrect routing when users change.",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-frontend-always-initializes-backend-access-control-before-any-authenticated-profile-queries-run-so-that-the-post-login-onboarding-guard-can-successfully-call-getcalleruserprofile-without-showing-the-error-screen-titled-unable-to-load-your-account",
      "title": "Ensure the frontend always initializes backend access control before any authenticated/profile queries run so that the post-login onboarding guard can successfully call `getCallerUserProfile()` without showing the error screen titled \"Unable to load your account\".",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-actor-lifecycle-query-invalidation-behavior-so-that-creating-recreating-the-backend-actor-does-not-immediately-refetch-all-react-query-queries-avoiding-unnecessary-post-login-churn-and-reducing-chances-of-transient-profile-load-failures-that-surface-as-unable-to-load-your-account",
      "title": "Update the actor lifecycle query invalidation behavior so that creating/recreating the backend actor does not immediately refetch all React Query queries, avoiding unnecessary post-login churn and reducing chances of transient profile-load failures that surface as \"Unable to load your account\".",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-login-page-so-the-email-password-input-fields-remain-interactive-type-tap-works-even-when-the-backend-actor-is-still-initializing-only-the-action-controls-that-require-the-backend-e-g-the-login-submit-button-should-be-disabled-until-the-system-is-ready",
      "title": "Update the Login page so the email/password input fields remain interactive (type/tap works) even when the backend actor is still initializing; only the action controls that require the backend (e.g., the \"Login\" submit button) should be disabled until the system is ready.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-on-the-login-page-add-clear-english-user-facing-messaging-for-the-not-ready-state-that-explains-why-login-cannot-be-submitted-yet-e-g-initializing-system-login-will-be-available-shortly-without-blocking-interaction-with-the-input-fields",
      "title": "On the Login page, add clear English user-facing messaging for the not-ready state that explains why login cannot be submitted yet (e.g., \"Initializing system…\" / \"Login will be available shortly\"), without blocking interaction with the input fields.",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-update-backend-actor-initialization-to-be-resilient-to-transient-startup-network-failures-automatically-retry-initialization-instead-of-immediately-surfacing-the-error-text-failed-to-connect-to-the-backend-system-please-refresh-the-page-to-try-again-during-the-initial-load",
      "title": "Update backend actor initialization to be resilient to transient startup/network failures: automatically retry initialization instead of immediately surfacing the error text \"Failed to connect to the backend system. Please refresh the page to try again.\" during the initial load.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-adjust-the-login-screen-messaging-and-submit-behavior-so-that-backend-not-ready-is-handled-as-a-non-destructive-readiness-state-not-a-login-error-and-does-not-instruct-users-to-refresh-the-page",
      "title": "Adjust the Login screen messaging and submit behavior so that backend-not-ready is handled as a non-destructive readiness state (not a login error) and does not instruct users to refresh the page.",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-prevent-the-post-login-onboarding-guard-from-repeatedly-showing-the-destructive-error-screen-unable-to-load-your-account-for-transient-profile-load-failures-by-adding-automatic-retry-backoff-for-fetching-the-current-user-profile-and-only-surfacing-a-destructive-error-after-retries-are-exhausted",
      "title": "Prevent the post-login onboarding guard from repeatedly showing the destructive error screen (\"Unable to load your account\") for transient profile-load failures by adding automatic retry/backoff for fetching the current user profile and only surfacing a destructive error after retries are exhausted.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-onboarding-status-query-behavior-so-that-it-is-resilient-and-does-not-immediately-fail-on-first-attempt-configure-react-query-retries-for-the-current-user-profile-query-and-ensure-error-messages-shown-to-users-are-generic-english-and-do-not-instruct-users-to-refresh-the-page",
      "title": "Update the onboarding status query behavior so that it is resilient and does not immediately fail on first attempt: configure React Query retries for the current user profile query and ensure error messages shown to users are generic, English, and do not instruct users to refresh the page.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-backend-actor-initialization-access-control-initialization-state-does-not-trigger-repeated-onboarding-profile-errors-keep-the-onboarding-profile-queries-disabled-until-the-backend-actor-is-fully-ready-and-avoid-any-state-transitions-that-would-cause-repeated-error-retry-loops-during-actor-initialization",
      "title": "Ensure the backend actor initialization / access-control initialization state does not trigger repeated onboarding/profile errors: keep the onboarding/profile queries disabled until the backend actor is fully ready, and avoid any state transitions that would cause repeated error->retry loops during actor initialization.",
      "reqIds": [
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "feature-add-explicit-user-friendly-frontend-fallback-states-on-option-pages-that-can-appear-to-not-load-including-onboarding-guard-and-role-based-pages-when-required-data-is-unavailable-e-g-profile-is-null-location-is-missing-actor-is-not-ready-or-a-query-fails-show-clear-english-messaging-and-actionable-controls-e-g-retry-go-to-login-instead-of-only-a-spinner-or-a-silent-non-render-apply-this-to-requireonboarding-recruiter-browsing-and-job-seeker-application-pages-that-depend-on-profile-location-application-queries",
      "title": "Add explicit, user-friendly frontend fallback states on option/pages that can appear to “not load”, including onboarding guard and role-based pages. When required data is unavailable (e.g., profile is null, location is missing, actor is not ready, or a query fails), show clear English messaging and actionable controls (e.g., Retry, Go to Login) instead of only a spinner or a silent non-render. Apply this to `RequireOnboarding`, recruiter browsing, and job seeker application pages that depend on profile/location/application queries.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-login-to-onboarding-flow-so-users-do-not-get-stuck-on-a-post-login-can-t-load-state-and-the-role-selection-screen-red-search-for-reception-job-and-blue-search-for-receptionist-boxes-always-renders-after-a-successful-login-when-the-user-has-not-completed-onboarding",
      "title": "Fix the login-to-onboarding flow so users do not get stuck on a post-login 'can't load' state, and the Role Selection screen (red 'Search for reception job' and blue 'Search for receptionist' boxes) always renders after a successful login when the user has not completed onboarding.",
      "reqIds": [
        "REQ-26"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-frontend-login-page-to-correctly-interpret-the-backend-authenticateuser-response-and-only-proceed-set-authenticated-session-navigate-to-onboarding-when-authentication-is-successful-show-a-clear-english-error-message-when-credentials-are-invalid",
      "title": "Update the frontend Login page to correctly interpret the backend authenticateUser response and only proceed (set authenticated session + navigate to onboarding) when authentication is successful; show a clear English error message when credentials are invalid.",
      "reqIds": [
        "REQ-28"
      ],
      "version": 1
    },
    {
      "id": "feature-remove-inconsistent-backend-actor-usage-in-onboarding-screens-by-ensuring-the-role-selection-page-uses-the-same-backend-actor-context-as-the-rest-of-the-authenticated-onboarding-flow-backendactorprovider-so-role-selection-calls-and-subsequent-profile-refetching-work-reliably",
      "title": "Remove inconsistent backend-actor usage in onboarding screens by ensuring the Role Selection page uses the same backend actor context as the rest of the authenticated/onboarding flow (BackendActorProvider), so role selection calls and subsequent profile refetching work reliably.",
      "reqIds": [
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-react-query-cache-reset-invalidation-around-the-current-user-profile-query-so-it-correctly-targets-the-same-query-keys-used-by-onboarding-status-including-the-current-user-identity-key-preventing-stale-null-profile-states-that-block-navigation-to-the-role-selection-screen",
      "title": "Fix React Query cache reset/invalidation around the current user profile query so it correctly targets the same query keys used by onboarding status (including the current user identity key), preventing stale/null profile states that block navigation to the role selection screen.",
      "reqIds": [
        "REQ-30"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-signup-ui-frontend-src-features-auth-signuppage-tsx-to-correctly-handle-the-backend-registeruser-result-type-and-show-clear-english-error-messages-using-the-backend-error-codes-e-g-already-registered-unauthorized-instead-of-assuming-success-when-the-call-resolves",
      "title": "Update the Signup UI (`frontend/src/features/auth/SignupPage.tsx`) to correctly handle the backend `registerUser` Result type and show clear English error messages using the backend error codes (e.g., already registered, unauthorized) instead of assuming success when the call resolves.",
      "reqIds": [
        "REQ-34"
      ],
      "version": 1
    },
    {
      "id": "feature-audit-the-frontend-for-any-user-facing-text-that-says-or-implies-that-only-admins-can-choose-a-role-e-g-only-admins-choose-role-and-replace-it-with-accurate-english-messaging-that-indicates-any-logged-in-user-can-choose-their-role-during-onboarding",
      "title": "Audit the frontend for any user-facing text that says or implies that only admins can choose a role (e.g., \"only admins choose role\"), and replace it with accurate English messaging that indicates any logged-in user can choose their role during onboarding.",
      "reqIds": [
        "REQ-38"
      ],
      "version": 1
    },
    {
      "id": "feature-on-the-role-selection-page-ensure-that-if-role-selection-fails-due-to-an-authorization-session-issue-the-error-message-shown-to-the-user-is-clear-english-and-does-not-reference-admins-it-must-guide-the-user-to-log-in-again-e-g-provide-a-go-to-login-action",
      "title": "On the Role Selection page, ensure that if role selection fails due to an authorization/session issue, the error message shown to the user is clear English and does not reference admins; it must guide the user to log in again (e.g., provide a \"Go to Login\" action).",
      "reqIds": [
        "REQ-39"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "App branding + welcome screen that displays \"welcome to helthcare reception.\" on launch",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Authentication: login with email + password",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Account creation form: name, email, phone number, gender, and suggested password; redirect to login after signup",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Post-login role selection screen with two options: red box \"search for reception job\" and blue box \"search for receptionist\" (shown once on first login)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "First-time area/location form after role selection: city, district, state, country",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Job seeker flow (red): upload photo from gallery, submit application, and show confirmation message \"your application applied\"; store/send name, email, phone, gender, photo, and area",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Job seeker home page (red): option to change/update submitted information",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Recruiter flow (blue): after area info, show list of applicants (red users) in the same area",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Create backend data models and methods to support: user registration, login, onboarding status (role selected + area completed), saving/updating a job seeker application (including photo data), and querying job seeker applications by area for recruiters.",
      "reqIds": [
        "REQ-9"
      ],
      "status": "pending"
    },
    {
      "id": "AR-18",
      "summary": "Reduce slow post-login loading by preventing unnecessary global React Query refetches triggered when the backend actor becomes available or changes (identity change). Specifically, do not force an immediate refetch of *all* queries after actor creation; instead, only invalidate relevant queries and let screens refetch on demand.",
      "reqIds": [
        "REQ-11"
      ],
      "status": "pending"
    },
    {
      "id": "AR-19",
      "summary": "Prevent the \"Failed to connect to the backend system. Please refresh the page to try again.\" message from appearing during backend actor initialization; add resilient retry/ready-state handling instead of surfacing a connection error on the login screen",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-20",
      "summary": "Fix backend user identity/storage so multiple users do not overwrite each other and screens do not fail to load due to missing/incorrect profile data. Replace the current hard-coded principal assignment in `registerUser` (currently `Principal.fromText(\"2vxsx-fae\")`) with a stable per-user identifier so each registered email maps to a distinct user record, and update all profile/application storage maps and lookups accordingly.",
      "reqIds": [
        "REQ-23"
      ],
      "status": "pending"
    },
    {
      "id": "AR-21",
      "summary": "Update backend error handling for missing user records so the app can recover gracefully instead of leaving users stuck on non-loading screens. Specifically, for onboarding and application methods that currently trap with \"User profile not found\" (e.g., `setUserRole`, `setUserLocation`, `submitJobApplication`, `updateJobApplication`, `getMyJobApplication`, `searchApplicantsByLocation`), return a safe, consistent response or a clear, non-destructive error that the frontend can render and provide a retry/re-login path for.",
      "reqIds": [
        "REQ-24"
      ],
      "status": "pending"
    },
    {
      "id": "AR-23",
      "summary": "Correct the backend authentication/profile linkage so that a successful email/password login can consistently load the correct user profile used for onboarding (role/location), rather than returning null or triggering unauthorized/profile-not-found states.",
      "reqIds": [
        "REQ-27"
      ],
      "status": "pending"
    },
    {
      "id": "AR-24",
      "summary": "Re-enable backend email/password account registration in `backend/main.mo` by implementing `registerUser(userProfile, password)` instead of always returning `#err(#unauthorized)`.",
      "reqIds": [
        "REQ-31"
      ],
      "status": "pending"
    },
    {
      "id": "AR-25",
      "summary": "Re-enable backend email/password login in `backend/main.mo` by implementing `authenticateUser(email, password)` instead of always returning `#err(#unauthorized)` and ensure it authenticates the caller against stored credentials.",
      "reqIds": [
        "REQ-32"
      ],
      "status": "pending"
    },
    {
      "id": "AR-26",
      "summary": "Make backend profile fetching resilient so a missing profile does not trap: update `getCallerUserProfile()` and `getUserProfile()` in `backend/main.mo` to return `null` (or a non-trapping safe response) when the profile is missing, rather than `Runtime.trap(...)`.",
      "reqIds": [
        "REQ-33"
      ],
      "status": "pending"
    },
    {
      "id": "AR-27",
      "summary": "Re-enable email/password account registration and login in `backend/main.mo` by implementing `registerUser(userProfile, password)` and `authenticateUser(email, password)` (they currently return `#err(#unauthorized)`), including correct per-user storage so multiple users do not overwrite each other.",
      "reqIds": [
        "REQ-35"
      ],
      "status": "pending"
    },
    {
      "id": "AR-28",
      "summary": "Make profile fetch methods non-destructive by removing `Runtime.trap(...)` from `getCallerUserProfile()` and `getUserProfile(user)` in `backend/main.mo`; instead return a safe value (`null`) when the profile is missing, and keep authorization checks consistent with existing access-control behavior.",
      "reqIds": [
        "REQ-36"
      ],
      "status": "pending"
    },
    {
      "id": "AR-29",
      "summary": "Ensure successful email/password authentication results in the caller being treated as an authenticated user for subsequent backend calls that check `AccessControl.hasPermission(..., #user)` (e.g., role/location setters and application methods).",
      "reqIds": [
        "REQ-37"
      ],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Helthcare Reception",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}